# بلوپرینت اپلیکیشن مدیریت گیم‌نت

این سند، طرح کلی و برنامه‌ی پیاده‌سازی اپلیکیشن مدیریت گیم‌نت بر اساس اسکریپت پایتون `test/تست عالی.pyw` در فریم‌ورک فلاتر را تشریح می‌کند. هدف اصلی، بازسازی کامل برنامه با حفظ تمام قابلیت‌ها، ظاهر و منطق، و افزودن پشتیبانی کامل از زبان فارسی و چیدمان راست-به-چپ (RTL) است.

## بخش ۱: نمای کلی و قابلیت‌های اصلی

این اپلیکیشن برای مدیریت یک گیم‌نت طراحی شده و شامل سه بخش اصلی است: **میز بازی**، **دفتر حساب** و **تنظیمات**.

### ویژگی‌های کلیدی:

1.  **مدیریت دستگاه‌ها:**
    *   نمایش ۸ دستگاه PC و ۴ دستگاه PS4 با نام و آیکون مشخص.
    *   شروع و پایان تایمر برای هر دستگاه با یک کلیک.
    *   محاسبه‌ی هزینه بر اساس زمان و قیمت تعریف‌شده.
    *   امکان پرداخت نقدی یا افزودن هزینه به حساب دفتری مشتری.

2.  **تایمرهای گروهی (پرچم‌ها):**
    *   ۴ تایمر گروهی رنگی برای بازی‌های تیمی.
    *   امکان انتخاب بازندگان و ثبت بدهی "بازی" در حساب دفتری آن‌ها.

3.  **دفتر حساب (مدیریت مشتریان):**
    *   افزودن، حذف، جستجو و ویرایش مشتریان.
    *   نمایش جزئیات حساب هر مشتری، شامل بدهی‌های تفکیک‌شده (PC, PS4, بازی، کیک و...).
    *   سیستم پرداخت هوشمند برای تسویه بدهی‌ها با استفاده از اعتبار و پرداخت جدید.

4.  **تنظیمات:**
    *   قابلیت ویرایش و ذخیره‌سازی قیمت تمام آیتم‌ها.

5.  **ذخیره‌سازی و پایداری داده‌ها:**
    *   تمام اطلاعات (مشتریان، قیمت‌ها، بدهی‌ها و اعتبارات) به صورت خودکار در فایل‌های JSON محلی ذخیره می‌شوند.

6.  **تجربه‌ی کاربری (UX):**
    *   پشتیبانی کامل از **زبان فارسی** و چیدمان **راست-به-چپ (RTL)**.
    *   پوسته‌ی تاریک و مدرن با پالت رنگی مشخص برای راحتی چشم.
    *   نمایش پیغام تأیید هنگام خروج در صورت وجود تایمرهای فعال.

## بخش ۲: برنامه‌ی پیاده‌سازی در فلاتر

### فاز ۱: پیکربندی اولیه و ساختار پروژه

1.  **پیکربندی فارسی‌سازی و RTL:**
    *   افزودن بسته‌ی `flutter_localizations` به `pubspec.yaml`.
    *   پیکربندی `MaterialApp` در `main.dart` برای پشتیبانی از `locale: const Locale('fa')` و `supportedLocales`.
    *   استفاده از فونت فارسی مناسب (مانند Vazirmatn) در کل پروژه.

2.  **ایجاد ساختار فایل و مدل‌ها:**
    *   اصلاح مدل‌های `Contact`, `Price`, `DeviceTimer` و `GroupTimer` برای تطابق کامل با ساختار داده‌های JSON در اسکریپت پایتون.
    *   اطمینان از صحت عملکرد `toJson` و `fromJson` برای همه‌ی مدل‌ها.

3.  **طراحی Theme (پوسته):**
    *   ایجاد یک `ThemeData` سفارشی در `main.dart` بر اساس پالت رنگی و استایل‌های تعریف‌شده در فایل پایتون (`COLOR_BACKGROUND`, `COLOR_PRIMARY` و...).
    *   تعریف استایل‌های مشخص برای دکمه‌ها، لیبل‌ها، کارت‌ها و فیلدهای ورودی.

### فاز ۲: پیاده‌سازی منطق Provider ها

1.  **بازسازی `PriceProvider`:**
    *   بارگیری و ذخیره‌سازی قیمت‌ها از `prices.json`.
2.  **بازسازی `ContactProvider`:**
    *   بارگیری و ذخیره‌سازی اطلاعات مشتریان و بدهی‌های آن‌ها از `contacts.json`.
    *   بارگیری و ذخیره‌سازی اعتبارات از `credits.json`.
    *   پیاده‌سازی متدهای `addContact`, `removeContact`, `updateContact`, و منطق پرداخت هوشمند (`apply_payment`).
3.  **بازسازی `TimerProvider`:**
    *   مقداردهی اولیه‌ی ۸ دستگاه PC و ۴ دستگاه PS4.
    *   مقداردهی اولیه‌ی ۴ تایمر گروهی.
    *   پیاده‌سازی منطق شروع، توقف و محاسبه‌ی هزینه‌ی تایمرهای دستگاه و گروه.

### فاز ۳: بازسازی واسط کاربری (UI)

1.  **صفحه‌ی اصلی (`HomeScreen`):**
    *   ایجاد `BottomNavigationBar` با سه تب: "میز بازی"، "دفتر حساب" و "تنظیمات".
    *   پیاده‌سازی منطق تأیید خروج (`_onWillPop`) به زبان فارسی.

2.  **تب "میز بازی" (`GameTableScreen`):**
    *   نمایش دستگاه‌ها در یک `GridView` با چیدمان راست-به-چپ.
    *   نمایش پرچم‌ها در یک ستون در سمت چپ صفحه.
    *   پیاده‌سازی کامل پنجره‌های دیالوگ (Dialogs) برای پایان بازی و انتخاب بازندگان با متن فارسی.

3.  **تب "دفتر حساب" (`AccountBookScreen`):**
    *   طراحی صفحه‌ی دو بخشی (لیست مشتریان و جزئیات حساب) با چیدمان RTL.
    *   استفاده از `ListView` برای نمایش لیست مشتریان و `TextFormField` برای جستجو.
    *   نمایش جزئیات بدهی با دکمه‌های `+` و `-` و فیلدهای ورودی قابل ویرایش.
    *   پیاده‌سازی کامل بخش پرداخت با متن‌های فارسی.

4.  **تب "تنظیمات" (`SettingsScreen`):**
    *   ایجاد فرمی برای ویرایش قیمت‌ها با لیبل‌های فارسی.

### فاز ۴: افزودن آیکون‌ها و منابع

1.  **کپی کردن آیکون‌ها:**
    *   کپی کردن فایل‌های `pc_icon.png` و `ps4.ico` به پوشه‌ی `assets/images`.
    *   تعریف این مسیر در فایل `pubspec.yaml`.

2.  **استفاده از آیکون‌ها:**
    *   استفاده از ویجت `Image.asset` برای نمایش آیکون‌ها در `DeviceCard`.

این برنامه‌ی کاری تضمین می‌کند که تمام جنبه‌های اپلیکیشن اصلی با دقت و به طور کامل در نسخه‌ی فلاتر پیاده‌سازی شوند.
